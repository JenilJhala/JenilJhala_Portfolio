@model List<SmallUsedCars_WebApp.Models.VehicleInventoryViewModel>

<h2>Inventory</h2>

@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger">
        <strong>Please fix the following errors:</strong>
        <ul>
            @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
            {
                <li>@error.ErrorMessage</li>
            }
        </ul>
    </div>
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}

<style>
    .vehicle-img {
        width: 80px; /* 이미지 크기 */
        height: auto; /* 원본 비율 유지 */
        border-radius: 5px; /* 모서리를 둥글게 */
    }
</style>

<table class="table">
    <thead>
        <tr>
            <th>Image</th>
            <th>Model</th>
            <th>Manufacturer</th>
            <th>Plate Number</th>
            <th>Mileage</th>
            <th>Status</th>
            <th>Transaction Type</th>
            @if (TempData["ShowAddVehicleForm"] == null)
            {
                <th>Actions</th>
            }
        </tr>
    </thead>
    <tbody>
        @foreach (var vehicle in Model)
        {
            <tr>
                <td>
                    
                    <img src="@Url.Content($"~/images/vehicles/{vehicle.ImageFileName}")"
                         alt="Vehicle Image" class="vehicle-img" onerror="this.onerror=null; this.src='/images/placeholder.jpg';" />
                </td>
                <td>@vehicle.Model</td>
                <td>@vehicle.Manufacturer</td>
                <td>@vehicle.PlateNumber</td>
                <td>@vehicle.Mileage</td>
                <td>@vehicle.Status</td>
                <td>
                    @if (vehicle.TransactionType == "Pending")
                    {
                        <span class="text-danger">@vehicle.TransactionType</span>
                    }
                </td>

                @if (TempData["ShowAddVehicleForm"] == null)
                {
                    <td>
                        <a asp-action="Edit" asp-route-id="@vehicle.VehicleId" class="btn btn-warning btn-sm">Edit</a>
                        <a asp-action="Delete" asp-route-id="@vehicle.VehicleId" class="btn btn-danger btn-sm">Delete</a>
                    </td>
                }
            </tr>
        }
    </tbody>
</table>

@if (TempData["ShowAddVehicleForm"] != null)
{
    <h3>Add New Vehicle</h3>
    <form asp-action="Add" method="post" class="border p-3 mt-3">
        <div class="mb-2">
            <label for="Vin" class="form-label">VIN</label>
            <input type="text" name="Vin" class="form-control" placeholder="Vehicle Identification Number" required />
        </div>
        <div class="mb-2">
            <label for="PlateNumber" class="form-label">Plate Number</label>
            <input type="text" name="PlateNumber" class="form-control" placeholder="Plate Number" required />
        </div>
        <div class="mb-2">
            <label for="Mileage" class="form-label">Mileage</label>
            <input type="text" name="Mileage" class="form-control" placeholder="Mileage" required />
        </div>
        <div class="mb-2">
            <label for="Type" class="form-label">Type</label>
            <input type="text" name="Type" class="form-control" placeholder="Vehicle Type (e.g., Sedan, SUV)" required />
        </div>
        <div class="mb-2">
            <label for="Powertrain" class="form-label">Powertrain</label>
            <input type="text" name="Powertrain" class="form-control" placeholder="Powertrain Type (e.g., Gasoline, Electric)" required />
        </div>
        <div class="mb-2">
            <label for="Model" class="form-label">Model</label>
            <input type="text" name="Model" class="form-control" placeholder="Model Name" required />
        </div>
        <div class="mb-2">
            <label for="Year" class="form-label">Year</label>
            <input type="number" name="Year" class="form-control" placeholder="Manufacturing Year" required />
        </div>
        <div class="mb-2">
            <label for="Manufacturer" class="form-label">Manufacturer</label>
            <input type="text" name="Manufacturer" class="form-control" placeholder="Manufacturer Name" required />
        </div>
        <div class="mb-2">
            <label for="Status" class="form-label">Status</label>
            <select name="Status" class="form-select">
                <option value="Available">Available</option>
                <option value="Sold">Sold</option>
                <option value="Under Repair">Under Repair</option>
                <option value="Under Inspection">Under Inspection</option>
            </select>
        </div>
        <div class="mb-2">
            <label for="MarketValue" class="form-label">Market Value</label>
            <input type="number" step="0.01" name="MarketValue" class="form-control" placeholder="Market Value ($)" required />
        </div>
        <button type="submit" class="btn btn-success">Add Vehicle</button>
    </form>
}
